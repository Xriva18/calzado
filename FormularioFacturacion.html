<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calzado</title>
    <!--Propio-->
    <link rel="stylesheet" href="./css/estilos.css">
    <!--BootStrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Footer-->
    <link rel="stylesheet" href="assets/css/fontawesome.min.css">
    <!-- CSS de Bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- JavaScript de Bootstrap y jQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <!---Propios-->
    <script type="text/javascript" src="./js/footerMostar.js"></script>
    <script type="text/javascript">
        function GenerarPDF() {
            // Aquí va la lógica para generar el PDF
            alert('Verificando su información');
        }

       
    </script>
</head>
<body>
    <!--Navbar-->
    <div class="container mt-3" style="z-index: 1;" id="dvContainerNV">
        <nav class="navbar navbar-expand-lg rounded shadow" style="background-color: #e3f2fd;" id="nvBarraNV">
            <div class="container-fluid bg-" id="dvFluidNV">
                <!--Btn con img-->
                <a class="navbar-brand" href="./index.html" id="aLogoNV">
                    <img src="./img/Logo1.png" alt="Mundo del calzado" width="50" height="50" id="imgLogoNV">
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation" id="btnToggleNV">
                    <!--Btn con Hamburguesa-->
                    <span class="navbar-toggler-icon" id="spnIconoNV"></span>
                    <!--Btn con img-->
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent" id="dvColapsoNV">
                    <div class="container navbar-collapse justify-content-center" id="dvContenedorInternoNV">
                        <ul class="nav nav-pills" id="ulMenuNV">
                            <li class="nav-item" id="liFormalNV">
                                <a class="nav-link" aria-current="page" href="#" id="aFormalNV">Formal</a>
                            </li>
                            <li class="nav-item" id="liDeportivoNV">
                                <a class="nav-link" href="./HDeportivo.html" id="aDeportivoNV">Deportivo</a>
                            </li>
                            <li class="nav-item dropdown" id="liDropdownNV">
                                <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false" id="aOtrosNV">
                                    Otros
                                </a>
                                <ul class="dropdown-menu" id="ulDropdownMenuNV">
                                    <li><a class="dropdown-item" href="#">Contáctanos</a></li>
                                    <li><a class="dropdown-item" href="#">¿Quiénes somos?</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div class="d-flex" id="carritoNV">
                        <a href="./carrito.html" class="btn btn-outline-primary d-flex" id="btnBuscarNV"><i class="bi bi-cart3"></i><span class="ml-2" id="cuenta-carrito">0</span></a>
                    </div>
                </div>
            </div>
        </nav>
    </div>
    <!--Facturación Start-->
    <div id="EspacioOcultar">&nbsp</div>
    <div class="row justify-content-center">
        <div id="dvPrestamo" class="col-11 col-sm-11 col-md-10 col-lg-8">
            <div class="card shadow">
                <div style="background-color: #e3f2fd;" class="card-header text-center p-3 TituloFormulario">
                    <h5 class="card-title">Facturación</h5>
                </div>
                <div class="card-body">
                    <div class="form-group row">
                        <div class="col-md-6 col-lg-6">
                            <label class="font-weight-bold w-100">Nombre: </label>
                            <div class="input-group">
                                <input type="text" class="form-control border" id="txtNombreCliente" required>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-6">
                            <label class="font-weight-bold w-100">Cédula: </label>
                            <div class="input-group">
                                <input type="text" class="form-control border" id="txtCedula" maxlength="10" pattern="\d{10}" title="La cédula debe tener 10 dígitos." required>
                            </div>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-md-6 col-lg-6">
                            <label class="font-weight-bold w-100">Correo: </label>
                            <div class="input-group">
                                <input type="email" class="form-control border" id="txtCorreo" required>
                            </div>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-md-6 col-lg-6">
                            <label class="font-weight-bold w-100">Método de Pago: </label>
                            <div>
                                <input type="radio" id="rbTarjeta" name="reb_pago" value="T">
                                <label for="rbTarjeta">Tarjeta de crédito/débito</label><br>
                                <input type="radio" id="rbDeposito" name="reb_pago" value="D">
                                <label for="rbDeposito">Depósito a cuenta</label><br>
                            </div>
                        </div>
                    </div>

                    <!-- Tarjeta de crédito/débito -->
                    <div id="tarjetaDiv" class="d-none">
                        <div style="background-color: #e3f2fd;" class="card-header text-center p-3 TituloFormulario">
                            <h5 class="card-title">Tarjeta de débito/crédito</h5>
                        </div>
                        <div class="form-group row">
                            <div class="col-md-8 col-lg-4 m-4">
                                <label class="font-weight-bold w-100">Nombre de la Tarjeta: </label>
                                <div class="input-group">
                                    <input type="text" class="form-control border" id="txtNombreTarjeta" required>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-md-4 col-lg-4 m-4">
                                <label class="font-weight-bold w-100">Número de la Tarjeta: </label>
                                <div class="input-group">
                                    <input type="text" class="form-control border" id="txtNumeroTarjeta" maxlength="16" pattern="\d{16}" title="El número de la tarjeta debe tener 16 dígitos." required>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-md-4 col-lg-4 m-4">
                                <label class="font-weight-bold w-100">CVC: </label>
                                <div class="input-group">
                                    <input type="text" class="form-control border" id="txtCVC" maxlength="3" pattern="\d{3}" title="El CVC debe tener 3 dígitos." required>
                                </div>
                            </div>
                            <div class="col-md-4 m-4">
                                <label class="font-weight-bold w-100">Fecha de Vencimiento:</label>
                                <div class="input-group">
                                    <input type="date" class="form-control border" id="txtFechaVencimiento" required>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Comprobante de depósito -->
                    <div id="depositoDiv" class="d-none">
                        <div style="background-color: #e3f2fd;" class="card-header text-center p-3 TituloFormulario">
                            <h5 class="card-title">Comprobante de depósito</h5>
                        </div>
                        <div class="form-group row">
                            <div class="col-md-8 col-lg-4 m-4">
                                <label class="font-weight-bold w-100">Número de Comprobante: </label>
                                <div class="input-group">
                                    <input type="text" class="form-control border" id="txtNumeroComprobante" maxlength="10" required>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row m-4">
                            <div>
                                <label class="font-weight-bold w-100">Subir comprobante: </label>
                                <div class="input-group">
                                    <input type="file" id="input-foto" class="form-control border" required>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row m-4">
                            <div class="col-md-12">
                                <img src="" id="previa" width="400" class="d-none">
                            </div>
                        </div>
                    </div>

                    <div class="form-group row m-4">
                        <div class="input-group" style="display: flex; justify-content: flex-end;">
                            <button type="button" class="btn btn-primary" id="btnGenerarPDF" onclick="if (validarFormulario()) { GenerarPDF(); alert('Su pago se realizó con éxito'); }">Pagar</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Contactanos Finish-->

    <!--Scripts-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="./js/navbar.js"></script>
    <script type="text/javascript" src="./js/cartService.js"></script>


    <script>
        const inputFile = document.querySelector('#input-foto');
        const image = document.querySelector('#previa');
        const tarjetaDiv = document.querySelector('#tarjetaDiv');
        const depositoDiv = document.querySelector('#depositoDiv');

        function encodeFileAsBase64URL(file) {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.addEventListener('loadend', () => {
                    resolve(reader.result);
                });
                reader.readAsDataURL(file);
            });
        }

        inputFile.addEventListener('input', async (event) => {
            if (inputFile.files.length > 0) {
                const base64URL = await encodeFileAsBase64URL(inputFile.files[0]);
                image.setAttribute('src', base64URL);
                image.classList.remove('d-none');
            }
        });

        document.querySelectorAll('input[name="reb_pago"]').forEach(radio => {
            radio.addEventListener('change', function() {
                if (document.getElementById('rbTarjeta').checked) {
                    tarjetaDiv.classList.remove('d-none');
                    depositoDiv.classList.add('d-none');
                } else if (document.getElementById('rbDeposito').checked) {
                    tarjetaDiv.classList.add('d-none');
                    depositoDiv.classList.remove('d-none');
                }
            });
        });
    </script>

    <script>
         function validarFormulario() {
            const nombre = document.getElementById('txtNombreCliente').value;
            const cedula = document.getElementById('txtCedula').value;
            const correo = document.getElementById('txtCorreo').value;
            const tarjeta = document.getElementById('txtNumeroTarjeta').value;
            const cvc = document.getElementById('txtCVC').value;
            const fecha = document.getElementById('txtFechaVencimiento').value;
            const comprobante = document.getElementById('input-foto').files.length;

            if (!nombre || !cedula || !correo) {
                alert('Por favor, complete todos los campos obligatorios.');
                return false;
            }

            if (!/^\d{10}$/.test(cedula)) {
                alert('La cédula debe tener 10 dígitos.');
                return false;
            }

            if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(correo)) {
                alert('Ingrese un correo electrónico válido.');
                return false;
            }

            if (document.getElementById('rbTarjeta').checked) {
                if (!tarjeta || !cvc || !fecha) {
                    alert('Complete todos los campos de la tarjeta.');
                    return false;
                }
                if (!/^\d{16}$/.test(tarjeta)) {
                    alert('El número de la tarjeta debe tener 16 dígitos.');
                    return false;
                }
                if (!/^\d{3}$/.test(cvc)) {
                    alert('El CVC debe tener 3 dígitos.');
                    return false;
                }
            }

            if (document.getElementById('rbDeposito').checked) {
                if (comprobante === 0) {
                    alert('Por favor, suba un comprobante de depósito.');
                    return false;
                }
            }

            return true;
        }
    </script>
</body>
</html>
